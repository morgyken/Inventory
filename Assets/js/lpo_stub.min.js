/*Samuel Dervis <sodhiambo@collabmed.com>*/
$("table").hide();$(document).ready(function(){$("select[name=supplier]").select2({theme:"bootstrap"});$(".date").datepicker({minDate:"0"});var c=1;$("#add_row").click(function(){var d='<td><select name="item'+c+'" class=" select2-single" style="width: 100%"></select></td><td><input type="text" name=\'qty'+c+"' placeholder='Quantity' value=\"1\"/></td><td><input type=\"text\" name='price"+c+"' placeholder='Price'/></td><td><span id=\"total"+c+'">0.00</span></td><td><button class="btn btn-xs btn-danger remove"><i class="fa fa-trash-o"></i></button></td>';$("#addr"+c).html(d);$("#tab_logic").append('<tr id="addr'+(c+1)+'"></tr>');b(c);c++});function a(){var d=0;$("#tab_logic tbody tr").each(function(e,h){var h=$(h);var j=h.find("input[name=qty"+e+"]").val();var g=h.find("input[name=price"+e+"]").val();var f=j*g;if(f){d=d+f;$("#total"+e).html(f.toFixed(2))}});$("#total").html(d.toFixed(2))}function b(d){$("#addr"+d+" select").select2({theme:"classic",placeholder:"Please select an item",formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,f){return"Please enter "+(f-e.length)+" more characters"},formatInputTooLong:function(f,e){return"Please enter "+(f.length-e)+" less characters"},formatSelectionTooBig:function(e){return"You can only select "+e+" items"},formatLoadMore:function(e){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumInputLength:2,allowClear:true,ajax:{url:PRODUCTS_URL,dataType:"json",cache:true,data:function(e,f){return{term:e}},results:function(f,e){return{results:f}}}});$("#addr"+d+" select").on("select2:select",function(e){var f=$(this).find("option:selected");var g=f.data().data.prices.price;$("input[name=price"+d+"]").val(g);a()});$("#addr"+d+" input").keyup(function(){a()});$(".remove").click(function(f){f.preventDefault();$(this).closest("tr").remove()})}b(0);$("table").show()});